# Custom Kernel Configuration for HP Pavilion (i5-10300H / Comet Lake-H)

# Derived from a generic Debian config and adjusted based on user input.

# 2.1 CPU & power-management
CONFIG_X86_INTEL_PSTATE=y
CONFIG_X86_HWP=y
CONFIG_CPU_FREQ_DEFAULT_GOV_SCHEDUTIL=y
CONFIG_INTEL_IDLE=y
CONFIG_ACPI_PROCESSOR_CSTATE=y
CONFIG_ACPI_PROCESSOR_IDLE=y

# 2.2 Microcode, RDRAND / RDSEED, entropy
CONFIG_MICROCODE=y
CONFIG_MICROCODE_INTEL=y
CONFIG_X86_MSR=y
CONFIG_X86_RDRAND=y
CONFIG_X86_RDSEED=y
CONFIG_ARCH_RANDOM=y
CONFIG_HW_RANDOM=y
CONFIG_HW_RANDOM_TPM=y
CONFIG_HW_RANDOM_INTEL=y

# 2.3 Crypto accelerators (AES-NI, SHA, CRC32C, etc.)
CONFIG_CRYPTO_AES_NI_INTEL=y
CONFIG_CRYPTO_AES_X86_64=y
CONFIG_CRYPTO_CRC32C_INTEL=y
CONFIG_CRYPTO_GLUE_HELPER_X86=y
CONFIG_CRYPTO_SHA1_SSSE3=y
CONFIG_CRYPTO_SHA256_SSSE3=y
CONFIG_CRYPTO_DEV_QAT=n

# 2.4 TSX, SGX, and speculative-exec odds and ends
CONFIG_X86_INTEL_TSX_MODE_OFF=y
CONFIG_X86_SGX=n
CONFIG_CPU_MITIGATIONS=y
CONFIG_SPECULATION_MITIGATIONS=y
# Assuming existing CONFIG_MITIGATION_* flags are retained or handled by oldconfig

# 2.5 Graphics / iGPU
CONFIG_DRM_I915=y
CONFIG_DRM_I915_GVT=n
CONFIG_DRM_I915_USERPTR=n
CONFIG_FRAMEBUFFER_CONSOLE=y
CONFIG_FB_EFI=y

# 2.6 Wi-Fi / Bluetooth (chipset-agnostic but practical)
CONFIG_CFG80211=y
CONFIG_MAC80211=y
CONFIG_IWLWIFI=m
CONFIG_IWLMVM=m
CONFIG_RTL8XXXU=m
CONFIG_RTW88=m
CONFIG_ATH9K=m
CONFIG_BT=m
CONFIG_BT_INTEL=m
CONFIG_BT_HCIUART=m

# Add other essential options from a standard Debian kernel config here.
# For example, basic filesystem support, networking, etc.
# This config fragment will be merged with a baseline config.

# Xen Hypervisor Support
CONFIG_XEN=y
CONFIG_XEN_PV=y
CONFIG_XEN_DOM0=y
CONFIG_XEN_PVHVM=y
CONFIG_XEN_GRANT_DMA_IOMMU=y
CONFIG_SWIOTLB_XEN=y
CONFIG_SND_XEN_FRONTEND=m
CONFIG_DRM_XEN=m
CONFIG_DRM_XEN_FRONTEND=m
CONFIG_XEN_FBDEV_FRONTEND=m